<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Free Padel Tournament Generator - Create Americano and Mexicano schedules instantly. The ultimate tool for padel organizers."
    />
    <title>Tournament Generator - Padel Companion</title>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://padelcompanion.se/tournament/" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://padelcompanion.se/tournament/" />
    <meta
      property="og:title"
      content="Tournament Generator - Padel Companion"
    />
    <meta
      property="og:description"
      content="Create Americano and Mexicano schedules instantly. The ultimate tool for padel organizers."
    />
    <meta
      property="og:image"
      content="https://padelcompanion.se/assets/app-icon.jpeg"
    />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta
      property="twitter:url"
      content="https://padelcompanion.se/tournament/"
    />
    <meta
      property="twitter:title"
      content="Tournament Generator - Padel Companion"
    />
    <meta
      property="twitter:description"
      content="Create Americano and Mexicano schedules instantly. The ultimate tool for padel organizers."
    />
    <meta
      property="twitter:image"
      content="https://padelcompanion.se/assets/app-icon.jpeg"
    />

    <link rel="icon" type="image/jpeg" href="/assets/app-icon.jpeg" />
    <link rel="apple-touch-icon" href="/assets/app-icon.jpeg" />
    <meta name="apple-mobile-web-app-title" content="Padel Tournament" />
    <meta name="theme-color" content="#0a0a0f" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/app.css" />
  </head>
  <body>
    <div id="header-slot"></div>

    <main class="tournament-page">
      <div class="container">
        <!-- Header -->
        <div class="tool-header">
          <div class="presented-by">
            <span>Presented by</span>
            <span class="sponsor-name text-gradient">Your Brand Here</span>
            <a href="mailto:wiklund.labs@gmail.com?subject=Sponsorship" class="sponsor-link" title="Become a sponsor">Become a sponsor</a>
          </div>
          <h1>Americano & Mexicano Generator</h1>
          <p>
            Create Americano and Mexicano schedules for your padel group in
            seconds.
          </p>
        </div>

        <!-- Setup Card (Basics) - Hidden by default, use interactive config instead -->
        <div class="setup-card card" id="setupCard" style="display: none;">
          <div class="card-header-basic">
            <h3>Tournament Setup</h3>
          </div>

          <div class="setup-grid">
            <!-- Format Selection -->
            <div class="form-group format-group">
              <div class="form-label-row">
                <label for="format" style="margin-bottom:0">Format</label>
                <button type="button" class="help-icon always-enabled" id="helpFormat">?</button>
              </div>
              <select
                id="format"
                class="form-select"
              >
                <option value="americano">Americano</option>
                <option value="mexicano">Mexicano</option>
                <option value="team">Team Americano</option>
                <option value="teamMexicano">
                  Team Mexicano
                </option>
              </select>
            </div>

            <!-- Court Naming -->
            <div class="form-group court-names-group">
              <label for="courtFormat">Court Names</label>
              <select id="courtFormat" class="form-select">
                <option value="court" selected>
                  Court 1, Court 2...
                </option>
                <option value="custom">Custom names</option>
              </select>
            </div>
          </div>

          <!-- Scoring Row: Mode + Points + Courts (3 columns) -->
          <div class="setup-grid-3">
            <!-- Scoring Mode -->
            <div class="form-group scoring-mode-group">
              <div class="form-label-row">
                <label for="scoringMode" style="margin-bottom:0">Scoring Mode</label>
                <button type="button" class="help-icon always-enabled" id="helpScoring">?</button>
              </div>
              <select
                id="scoringMode"
                class="form-select"
              >
                <option value="total" selected>Total Points</option>
                <option value="race">Race to Points</option>
                <option value="time">Time Based</option>
              </select>
            </div>

            <!-- Points Value -->
            <div class="form-group total-points-group">
              <label id="scoringValueLabel" for="points">Points</label>
              <input
                type="number"
                id="points"
                class="form-input"
                value="24"
                min="1"
                max="999"
              />
            </div>

            <!-- Courts -->
            <div class="form-group courts-group">
              <label for="courts">Courts</label>
              <input
                type="number"
                id="courts"
                class="form-input"
                value="2"
                min="1"
                max="50"
                oninput="validateCourts()"
              />
              <span
                id="courtsWarning"
                class="form-warning"
                style="display: none"
              ></span>
            </div>
          </div>

          <!-- Custom Court Names (shown when custom selected) -->
          <div
            id="customCourtNamesSection"
            style="display: none;"
          >
            <div id="customCourtNamesList" class="custom-court-names-grid">
              <!-- Dynamically generated inputs -->
            </div>
          </div>

          <!-- Advanced Settings now auto-show/hide based on format -->

          <!-- Advanced Settings Section (Inside Card) -->
          <div id="advancedSettingsContent" class="advanced-settings-content collapsed">
            <div class="control-divider-horizontal"></div>
            
            <div class="card-header-advanced">
              <div style="display: flex; align-items: center; gap: 8px;">
                <h3>Matchup Rules</h3>
                <button type="button" class="help-icon always-enabled" id="helpMatchup">?</button>
              </div>
              <p class="text-muted text-sm">
                Fine-tune how teams are formed and players are paired.
              </p>
            </div>

            <!-- Matchup Settings -->
            <div class="matchup-settings-content">
              <div class="setup-grid-2">
                <div class="form-group" id="maxRepeatsContainer">
                  <label for="maxRepeats">Max Partner Repeats</label>
                  <select id="maxRepeats" class="form-select always-enabled">
                    <option value="0">0 (never repeat)</option>
                    <option value="1">1 time</option>
                    <option value="2">2 times</option>
                    <option value="3">3 times</option>
                    <option value="99" selected>Unlimited</option>
                  </select>
                  <small class="form-hint"
                    >How many times players can partner with the same
                    person</small
                  >
                </div>

                <div class="form-group" id="pairingStrategyContainer">
                  <label for="pairingStrategy">Team Pairing Strategy</label>
                  <select id="pairingStrategy" class="form-select always-enabled">
                    <option value="oneThree">1 & 3 vs 2 & 4</option>
                    <option value="oneTwo">1 & 2 vs 3 & 4</option>
                    <option value="oneFour">1 & 4 vs 2 & 3</option>
                    <option value="optimal" selected>Optimal</option>
                  </select>
                  <div class="form-check" style="margin-top: 8px;">
                     <input type="checkbox" id="strictStrategy" class="form-checkbox always-enabled">
                     <label for="strictStrategy" class="form-label-inline" style="font-size: 0.9em; color: var(--text-secondary);">
                       Strict Pattern
                     </label>
                  </div>
                  <small class="form-hint"
                    >If checked, force strategy even if it causes repeats</small
                  >
                </div>
              </div>

              <div class="form-group preferred-partners-section" id="preferredPartnersContainer">
                <label
                  >Preferred Partners
                  <span class="optional-tag">(optional)</span></label
                >
                <div id="preferredPartnersList" class="preferred-partners-list">
                  <!-- Partner pairs will be added here -->
                </div>
                <button
                  type="button"
                  class="btn btn-secondary btn-sm"
                  id="addPartnerPairBtn"
                  disabled
                >
                  + Add Fixed Pair
                </button>
                <small class="form-hint"
                  >These players will always play together as a team</small
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Players Section -->
          <div class="players-section">
            <div class="players-header">
              <h3 id="playersHeader">
                Players <span class="player-count" id="playerCount">(0)</span>
              </h3>
              <div class="player-actions">
                <button
                  class="btn btn-danger btn-sm"
                  id="clearAllPlayersBtn"
                  title="Remove All Players"
                >
                  Clear All
                </button>
                <button class="btn btn-secondary btn-sm" id="importPlayersBtn">
                  Import...
                </button>
                <button class="btn btn-secondary btn-sm" id="addPlayerBtn">
                  + Add Player
                </button>
              </div>
            </div>

            <!-- Import Modal -->
            <div class="modal-overlay" id="importModal" style="display: none">
              <div class="modal">
                <div class="modal-header">
                  <h3>Import Players</h3>
                  <button class="close-modal" id="closeImportModal">
                    Close
                  </button>
                </div>
                <div class="modal-body">
                  <p class="modal-hint">
                    Paste names below (one per line, or comma separated).
                    Duplicates will be skipped.
                  </p>
                  <textarea
                    id="importTextarea"
                    class="form-input"
                    rows="8"
                    placeholder="Anna&#10;Bertil&#10;Cecilia, David..."
                  ></textarea>
                </div>
                <div class="modal-footer">
                  <span id="importStatus" class="import-status"></span>
                  <div class="modal-actions">
                    <button class="btn btn-ghost" id="cancelImportBtn">
                      Cancel
                    </button>
                    <button class="btn btn-primary" id="confirmImportBtn">
                      Import Players
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div
              class="player-input-row"
              id="playerInputRow"
              style="display: none"
            >
              <input
                type="text"
                class="form-input"
                id="playerNameInput"
                placeholder="Enter name..."
                maxlength="20"
              />
              <button class="btn btn-primary btn-sm" id="confirmAddBtn">
                Add
              </button>
              <button class="btn btn-ghost btn-sm" id="cancelAddBtn">
                Cancel
              </button>
            </div>

            <div class="player-list-wrapper expanded" id="playerListWrapper">
              <ul class="player-list" id="playerList">
                <!-- Players will be added here -->
              </ul>
            </div>
            <button
              class="expand-players-btn"
              id="expandPlayersBtn"
              onclick="togglePlayerList()"
            >
              Show Less ▲
            </button>

            <p class="players-hint" id="playersHint">
              Add at least 4 players to generate a schedule
            </p>
          </div>

          <!-- Interactive Tournament Configuration -->
          <div class="tournament-config" id="tournamentConfig">
            <!-- Generated by tournamentConfig.js -->
          </div>

          <!-- Old summary for fallback (hidden) -->
          <div class="tournament-summary" id="tournamentSummary" style="display: none;">
            <h4 class="summary-title">Your Tournament</h4>
            <ul class="summary-list" id="summaryList"></ul>
          </div>

          <!-- Generate Button -->
          <button class="btn btn-primary btn-lg" id="generateBtn" disabled>
            Generate Schedule
          </button>
        </div>

        <!-- Schedule Output -->
        <div
          class="schedule-section"
          id="scheduleSection"
          style="display: none"
        >


          <div class="sticky-wrapper">
            <div class="schedule-toolbar" id="scheduleToolbar">
              <span class="toolbar-label">View:</span>
              <div class="schedule-controls" id="scheduleControlsContent">
                <div class="control-group">
                  <label for="gridColumns">Cols:</label>
                  <input
                    type="range"
                    id="gridColumns"
                    min="0"
                    max="6"
                    value="0"
                    step="1"
                  />
                  <span id="gridColumnsLabel" class="range-value">Auto</span>
                </div>
                <div class="control-divider"></div>
                <div class="control-group">
                  <label for="textSize">Text:</label>
                  <input
                    type="range"
                    id="textSize"
                    min="50"
                    max="250"
                    value="100"
                    step="10"
                  />
                <span id="textSizeLabel" class="range-value">100%</span>
                </div>
              </div>

            </div>
          </div>

          <!-- Match Timer (Hidden by default, shown for Time mode) -->
          <div
            id="matchTimerContainer"
            class="timer-container"
            style="display: none"
          >
            <div class="timer-wrapper">
              <div class="timer-display" id="timerDisplay" title="Click to edit time" style="cursor: pointer;">12:00</div>
            </div>
            <div class="timer-controls">
              <button class="btn btn-primary btn-sm" id="timerStartBtn">
                Start
              </button>
              <button
                class="btn btn-secondary btn-sm"
                id="timerPauseBtn"
                style="display: none"
              >
                Pause
              </button>
              <button class="btn btn-ghost btn-sm" id="timerResetBtn">
                Reset
              </button>
              <button class="btn btn-ghost btn-sm" id="timerSubBtn">
                -1m
              </button>
              <button class="btn btn-ghost btn-sm" id="timerAddBtn">
                +1m
              </button>
            </div>
          </div>

          <div class="schedule-header-row">
            <h2 class="section-title">Tournament Schedule</h2>
            <span class="status-badge" id="runningBadge" style="display: none;">Running</span>
          </div>
          
          <div id="gameDetails" class="game-details"></div>

          <div class="rounds-container" id="roundsContainer">
            <!-- Rounds will be generated here -->
          </div>
        </div>

        <!-- Tournament Actions -->
        <div id="tournamentActionsSection" class="tournament-actions" style="display: none;">
          <div class="actions-header">
            <h3>Tournament Controls</h3>
          </div>
          <div class="actions-grid">
            <button
              class="btn btn-secondary action-btn"
              onclick="promptAddLatePlayer()"
              title="Add a player who arrived late"
            >
              <span class="action-text">Add Late Player</span>
            </button>
            <button
              class="btn btn-secondary action-btn"
              id="undoBtn"
              title="Undo last action (Ctrl+Z)"
              disabled
            >
              <span class="action-text">Undo Last Action</span>
            </button>
            <button
              class="btn btn-secondary action-btn"
              id="resetBtn"
              title="Reset Tournament - Start over with same players"
            >
              <span class="action-text">Reset Tournament</span>
            </button>
            <button
              class="btn btn-danger action-btn"
              onclick="endTournament()"
              title="End Tournament - Finalize results"
            >
              <span class="action-text">End Tournament</span>
            </button>
          </div>
        </div>

        <!-- Leaderboard (for Mexicano) -->
        <div
          class="leaderboard-section"
          id="leaderboardSection"
          style="display: none"
        >
          <div class="leaderboard-header">
            <div style="display: flex; align-items: center; gap: 8px;">
              <h3>Leaderboard</h3>
              <button type="button" class="help-icon always-enabled" id="helpLeaderboard">?</button>
            </div>
            <div class="leaderboard-controls">
              <div class="controls-left">
                <button
                  id="togglePositionBtn"
                  class="btn btn-secondary btn-sm toggle-off"
                  onclick="togglePositionChanges()"
                  title="Toggle rank change indicators"
                >Ranks</button>
                <button
                  id="toggleVisibilityBtn"
                  class="btn btn-secondary btn-sm toggle-off"
                  onclick="toggleLeaderboardVisibility()"
                  title="Toggle score visibility"
                >Scores</button>
              </div>

              <div class="controls-right">
                <select
                  id="rankingCriteria"
                  class="form-select btn-sm"
                >
                  <option value="points" selected>Points</option>
                  <option value="wins">Wins</option>
                  <option value="winRatio">Win %</option>
                  <option value="pointRatio">Pts %</option>
                </select>
                <button
                  class="btn btn-secondary btn-sm"
                  id="printBtn"
                  title="Print Schedule/Result"
                >
                  Print
                </button>
              </div>
            </div>
          </div>
          <div class="table-responsive">
            <table class="leaderboard-table">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Player</th>
                  <th>Pts</th>
                  <th>W</th>
                  <th title="Score Difference">Diff</th>
                  <th title="Win Rate">%</th>
                  <th>Pl</th>
                </tr>
              </thead>
              <tbody id="leaderboardBody">
                <!-- Leaderboard rows -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- History Section -->


      <!-- History Section (List View) -->
      <section class="section history-section-page" id="historySectionPage" style="display: block; margin-top: var(--space-xl);">
        <div class="container">
          <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
             <h2>Past Tournaments</h2>
             <div class="search-wrapper">
               <input type="text" id="historySearch" placeholder="Filter by winner, date..." class="form-input search-input" />
             </div>
          </div>

          <div class="table-responsive history-table-wrapper">
            <table class="history-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Format</th>
                  <th>Winner</th>
                  <th>Players</th>
                  <th style="text-align: right;">Actions</th>
                </tr>
              </thead>
              <tbody id="historyTableBody">
                <!-- Rows injected by JS -->
              </tbody>
            </table>
            <div id="historyEmptyStatePage" class="empty-state-page" style="display: none; padding: 2rem; text-align: center;">
               <p class="text-muted">No history found.</p>
            </div>
          </div>
        </div>
      </section>

      </div>
    </main>

    <!-- Partners Section -->
    <!-- Partners Section -->
    <div id="partner-slot"></div>

    <div id="footer-slot"></div>

    <!-- Scroll to Top Button -->
    <button id="scrollTopBtn" class="scroll-top-btn" aria-label="Scroll to top" title="Back to top">
      ↑
    </button>

    <script type="module" src="/src/tournament/main.js"></script>
    <!-- 100% privacy-first analytics -->
    <script data-collect-dnt="true" async src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
    <noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif?collect-dnt=true" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript>
  </body>
</html>
