import{u as w,b as R,r as x,s as k,j as e,R as L}from"./main-B3_jEoeY.js";import{C as I,T as O}from"./TournamentNav-D0k2sZ-U.js";import{B as y}from"./Button-L0Fi6IqF.js";import{a as U}from"./seo-B5O_zVxb.js";function S(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function B(t){return Math.log2(t)}function C(t,i){const s=new Array(i).fill(null);return t.forEach((n,a)=>{a<i&&(s[a]=n)}),s}function A(t,i,s=0){const n=[];let a=1+s;const l=t.length/2,o=[];for(let u=0;u<l;u++){const c={id:a++,round:1,team1:t[u*2],team2:t[u*2+1],score1:null,score2:null,winner:null,nextMatchId:null,prevMatch1Id:null,prevMatch2Id:null};c.team1&&!c.team2?c.winner=c.team1:!c.team1&&c.team2&&(c.winner=c.team2),o.push(c),n.push(c)}let d=o;for(let u=2;u<=i;u++){const c=[],p=d.length/2;for(let m=0;m<p;m++){const h=d[m*2],b=d[m*2+1],f={id:a++,round:u,team1:h.winner,team2:b.winner,score1:null,score2:null,winner:null,nextMatchId:null,prevMatch1Id:h.id,prevMatch2Id:b.id};h.nextMatchId=f.id,b.nextMatchId=f.id,c.push(f),n.push(f)}d=c}return n}function G(t){if(t.length<2)throw new Error("Need at least 2 teams for a bracket");const i=S(t.length),s=B(i),n=C(t,i),a=A(n,s);return{teams:t,matches:a,numRounds:s,isDualBracket:!1}}function K(t,i){if(i==="manual")return t;if(i==="random"){const s=[...t].sort(()=>Math.random()-.5),n=Math.ceil(s.length/2);return t.map(a=>{const l=s.findIndex(o=>o.id===a.id);return{...a,side:l<n?"A":"B"}})}if(i==="alternate")return t.map((s,n)=>({...s,side:n%2===0?"A":"B"}));if(i==="half"){const s=Math.ceil(t.length/2);return t.map((n,a)=>({...n,side:a<s?"A":"B"}))}return t}function E(t,i=!0){if(t.length<2)throw new Error("Need at least 2 teams for a bracket");const s=t.filter(v=>v.side==="A"),n=t.filter(v=>v.side==="B");if(s.length===0&&n.length===0){const v=Math.ceil(t.length/2);return t.slice(0,v).forEach(N=>N.side="A"),t.slice(v).forEach(N=>N.side="B"),E(t,i)}const a=s.length>0?S(s.length):1,l=n.length>0?S(n.length):1,o=s.length>1?B(a):0,d=n.length>1?B(l):0,u=C(s,a),c=C(n,l),p=s.length>1?A(u,o,0):[],m=p.length>0?Math.max(...p.map(v=>v.id)):0,h=n.length>1?A(c,d,m):[],b=h.length>0?Math.max(...h.map(v=>v.id)):m;let f=null;return i&&(f={id:b+1,round:Math.max(o,d)+1,team1:null,team2:null,score1:null,score2:null,winner:null,nextMatchId:null,prevMatch1Id:p.length>0?p[p.length-1].id:null,prevMatch2Id:h.length>0?h[h.length-1].id:null},p.length>0&&(p[p.length-1].nextMatchId=f.id),h.length>0&&(h[h.length-1].nextMatchId=f.id)),{teams:t,teamsA:s,teamsB:n,matchesA:p,matchesB:h,grandFinal:f,numRoundsA:o,numRoundsB:d,isDualBracket:!0,hasSharedFinal:i}}function V(t,i,s,n){const a=o=>o.map(d=>{if(d.id===i){const u=s>n?d.team1:n>s?d.team2:null;return{...d,score1:s,score2:n,winner:u}}return d}),l=(o,d)=>{const u=o.find(c=>c.id===d);return!u||!u.winner||!u.nextMatchId?o:o.map(c=>{if(c.id===u.nextMatchId){if(c.prevMatch1Id===d)return{...c,team1:u.winner};if(c.prevMatch2Id===d)return{...c,team2:u.winner}}return c})};if(t.isDualBracket){const o=t;let d=a(o.matchesA),u=a(o.matchesB),c=o.grandFinal;if(d=l(d,i),u=l(u,i),c){const p=d[d.length-1],m=u[u.length-1];if(c={...c,team1:p?.winner||c.team1,team2:m?.winner||c.team2},i===c.id){const h=s>n?c.team1:n>s?c.team2:null;c={...c,score1:s,score2:n,winner:h}}}return{...o,matchesA:d,matchesB:u,grandFinal:c}}else{const o=t;let d=a(o.matches);return d=l(d,i),{...o,matches:d}}}const H=()=>{const{dispatch:t}=w(),i=R(),[s,n]=x.useState([]),[a,l]=x.useState(""),[o,d]=x.useState("teams"),[u,c]=x.useState("points"),[p,m]=x.useState(!1),[h,b]=x.useState(!0),[f,v]=x.useState("alternate"),N=x.useCallback(()=>{const r=a.trim();if(!r)return;const j={id:`team-${Date.now()}-${Math.random().toString(36).slice(2)}`,name:r,side:void 0};n(g=>[...g,j]),l("")},[a]),F=x.useCallback(r=>{n(j=>j.filter(g=>g.id!==r))},[]),_=x.useCallback(()=>{n([])},[]),$=x.useCallback(r=>{n(j=>j.map(g=>g.id===r?{...g,side:g.side==="A"?"B":"A"}:g)),v("manual")},[]),P=x.useCallback(()=>{if(s.length<2){k("Add at least 2 teams","error");return}try{const r={scoreType:u,mode:o};let j=s.map(g=>({id:g.id,name:g.name,side:g.side}));if(p){j=K(j,f);const g=E(j,h);t({type:"SET_BRACKET",bracket:g,config:r})}else{const g=G(j);t({type:"SET_BRACKET",bracket:g,config:r})}k("Bracket created!","success"),i("/tournament/bracket")}catch(r){console.error(r),k(`Error: ${r.message}`,"error")}},[s,p,f,h,u,o,t,i]),W=()=>{const r=s.length;if(r<2)return`Add at least ${2-r} more team${2-r>1?"s":""}`;if((r&r-1)===0&&r>=4)return e.jsxs("span",{style:{color:"var(--success)"},children:["âœ“ ",r," teams ready (perfect bracket)"]});const T=Math.pow(2,Math.ceil(Math.log2(r)))-r;return e.jsxs("span",{style:{color:"var(--warning)"},children:["âš  ",r," teams will have ",T," bye",T>1?"s":""]})},z=r=>r?r==="A"?{background:"rgba(59, 130, 246, 0.2)",color:"var(--accent)",border:"1px solid var(--accent)"}:{background:"rgba(245, 158, 11, 0.2)",color:"var(--warning)",border:"1px solid var(--warning)"}:{background:"rgba(255,255,255,0.1)",color:"var(--text-muted)",border:"1px solid var(--border-color)"};return e.jsxs("div",{className:"tournament-setup-view container animate-fade-in py-8",children:[e.jsxs("div",{className:"page-intro-header",children:[e.jsx("h2",{children:"Create a Bracket"}),e.jsx("p",{children:"Set up a single elimination tournament bracket."})]}),e.jsxs("div",{className:"setup-layout",children:[e.jsxs(I,{className:"setup-layout__main",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4",children:[o==="teams"?"Teams":"Players"," (",s.length,")"]}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[e.jsx("input",{type:"text",value:a,onChange:r=>l(r.target.value),onKeyDown:r=>r.key==="Enter"&&N(),placeholder:`Add ${o==="teams"?"team":"player"} name`,className:"player-list__input",style:{flex:1}}),e.jsx(y,{onClick:N,size:"sm",children:"Add"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",maxHeight:"400px",overflowY:"auto"},children:s.map((r,j)=>e.jsxs("div",{className:"player-card",style:{display:"flex",alignItems:"center",gap:"8px"},children:[p&&e.jsx("button",{onClick:()=>$(r.id),style:{...z(r.side),fontSize:"0.7rem",fontWeight:600,padding:"2px 8px",borderRadius:"4px",cursor:"pointer"},children:r.side?`Pool ${r.side}`:"Assign"}),e.jsxs("span",{className:"player-card__number",children:[j+1,"."]}),e.jsx("span",{className:"player-card__name",children:r.name}),e.jsx("button",{className:"player-card__remove",onClick:()=>F(r.id),children:"Ã—"})]},r.id))}),s.length>0&&e.jsx("div",{className:"player-list__hint",style:{marginTop:"16px"},children:W()}),s.length>0&&e.jsx(y,{variant:"secondary",size:"sm",onClick:_,className:"mt-4",children:"Clear All"})]}),e.jsxs(I,{className:"setup-layout__sidebar",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Settings"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"config-row",children:[e.jsx("label",{className:"config-label",children:"Type:"}),e.jsx("div",{className:"format-grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:["teams","players"].map(r=>e.jsx("div",{className:`segmented-option ${o===r?"selected":""}`,onClick:()=>d(r),children:r.charAt(0).toUpperCase()+r.slice(1)},r))})]}),e.jsxs("div",{className:"config-row",children:[e.jsx("label",{className:"config-label",children:"Score:"}),e.jsxs("select",{className:"form-select",value:u,onChange:r=>c(r.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",background:"var(--input-bg)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:[e.jsx("option",{value:"points",children:"Points"}),e.jsx("option",{value:"games",children:"Games"}),e.jsx("option",{value:"sets",children:"Sets"})]})]}),e.jsxs("div",{className:"config-row",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("label",{className:"config-label",children:"Pool Play:"}),e.jsx("div",{className:`ui-toggle ${p?"active":""}`,onClick:()=>m(!p),role:"switch","aria-checked":p,children:e.jsx("div",{className:"toggle-track",children:e.jsx("div",{className:"toggle-thumb"})})})]}),p&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"config-row",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("label",{className:"config-label",children:"Grand Final:"}),e.jsx("div",{className:`ui-toggle ${h?"active":""}`,onClick:()=>b(!h),role:"switch",children:e.jsx("div",{className:"toggle-track",children:e.jsx("div",{className:"toggle-thumb"})})})]}),e.jsxs("div",{className:"config-row",children:[e.jsx("label",{className:"config-label",children:"Assign to Pools:"}),e.jsx("div",{className:"format-grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[{value:"random",label:"Random"},{value:"alternate",label:"Alternate"},{value:"half",label:"Split Half"},{value:"manual",label:"Manual"}].map(r=>e.jsx("div",{className:`segmented-option ${f===r.value?"selected":""}`,onClick:()=>v(r.value),children:r.label},r.value))})]})]}),e.jsx(y,{size:"lg",disabled:s.length<2,onClick:P,className:"w-full mt-2",children:"Create Bracket"})]})]})]})]})},X=({match:t,onClose:i,onSave:s})=>{const{state:n}=w(),[a,l]=x.useState(t.score1?.toString()||""),[o,d]=x.useState(t.score2?.toString()||""),u=n.bracketConfig?.scoreType||"points",c=u.charAt(0).toUpperCase()+u.slice(1),p=()=>{const m=parseInt(a||"0"),h=parseInt(o||"0");if(m===h){k("Scores cannot be tied in elimination","error");return}s(m,h)};return e.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:m=>m.target===m.currentTarget&&i(),children:e.jsxs("div",{className:"modal score-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Enter Score"}),e.jsx("button",{className:"close-modal",onClick:i,children:"Close"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"score-type-label",style:{textAlign:"center",marginBottom:"12px",fontSize:"0.85rem",color:"var(--text-muted)"},children:["Scoring:"," ",e.jsx("strong",{style:{color:"var(--accent)"},children:c})]}),e.jsxs("div",{className:"score-entry-cards",children:[e.jsxs("div",{className:"score-card",children:[e.jsx("div",{className:"score-card-team",children:t.team1Name}),e.jsx("input",{type:"number",className:"form-input score-input",value:a,onChange:m=>l(m.target.value),min:"0",max:"99",placeholder:"0",autoFocus:!0})]}),e.jsx("div",{className:"score-divider",children:"VS"}),e.jsxs("div",{className:"score-card",children:[e.jsx("div",{className:"score-card-team",children:t.team2Name}),e.jsx("input",{type:"number",className:"form-input score-input",value:o,onChange:m=>d(m.target.value),min:"0",max:"99",placeholder:"0"})]})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx(y,{variant:"ghost",onClick:i,children:"Cancel"}),e.jsx(y,{onClick:p,children:"Save Score"})]})]})})};function Q(t,i){const s=i-t+1;return s===1?"FINAL":s===2?"SEMI-FINALS":s===3?"QUARTER-FINALS":`ROUND ${t}`}const D=({match:t,onClick:i,editable:s=!0})=>{const n=s&&t.team1&&t.team2;return e.jsxs("div",{className:`bracket-match ${n?"editable":""}`,onClick:()=>n&&i(t.id),style:{background:"var(--bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"8px 12px",marginBottom:"8px",cursor:n?"pointer":"default",minWidth:"140px"},children:[e.jsxs("div",{className:`match-team ${t.winner?.id===t.team1?.id?"winner":""}`,style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontWeight:t.winner?.id===t.team1?.id?600:400,color:t.winner?.id===t.team1?.id?"var(--success)":"var(--text-primary)"},children:[e.jsx("span",{children:t.team1?.name||"TBD"}),e.jsx("span",{style:{color:"var(--accent)"},children:t.score1??"-"})]}),e.jsxs("div",{className:`match-team ${t.winner?.id===t.team2?.id?"winner":""}`,style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontWeight:t.winner?.id===t.team2?.id?600:400,color:t.winner?.id===t.team2?.id?"var(--success)":"var(--text-primary)"},children:[e.jsx("span",{children:t.team2?.name||"TBD"}),e.jsx("span",{style:{color:"var(--accent)"},children:t.score2??"-"})]})]})},M=({matches:t,roundNum:i,totalRounds:s,onMatchClick:n})=>e.jsxs("div",{className:"bracket-round",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{className:"round-header",style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"12px",letterSpacing:"0.05em"},children:Q(i,s)}),e.jsx("div",{className:"round-matches",style:{display:"flex",flexDirection:"column",gap:"16px"},children:t.map(a=>e.jsx(D,{match:a,onClick:n},a.id))})]}),Y=({bracket:t,onMatchClick:i})=>{const s=x.useMemo(()=>{const n={};return t.matches.forEach(a=>{n[a.round]||(n[a.round]=[]),n[a.round].push(a)}),Object.entries(n).map(([a,l])=>({roundNum:parseInt(a),matches:l}))},[t.matches]);return e.jsx("div",{className:"single-bracket-view",style:{display:"flex",gap:"32px",overflowX:"auto",padding:"16px",justifyContent:"center"},children:s.map(({roundNum:n,matches:a})=>e.jsx(M,{matches:a,roundNum:n,totalRounds:t.numRounds,onMatchClick:i},n))})},q=({bracket:t,onMatchClick:i})=>{const s=x.useMemo(()=>{const a={};return t.matchesA.forEach(l=>{a[l.round]||(a[l.round]=[]),a[l.round].push(l)}),Object.entries(a).map(([l,o])=>({roundNum:parseInt(l),matches:o}))},[t.matchesA]),n=x.useMemo(()=>{const a={};return t.matchesB.forEach(l=>{a[l.round]||(a[l.round]=[]),a[l.round].push(l)}),Object.entries(a).map(([l,o])=>({roundNum:parseInt(l),matches:o}))},[t.matchesB]);return e.jsxs("div",{className:"dual-bracket-view",style:{display:"flex",gap:"24px",flexWrap:"wrap",justifyContent:"center",padding:"16px"},children:[e.jsxs("div",{className:"bracket-side side-a",style:{flex:1,minWidth:"280px",maxWidth:"400px",border:"2px solid rgba(59, 130, 246, 0.3)",borderRadius:"12px",padding:"16px",background:"rgba(59, 130, 246, 0.05)"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"16px"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"var(--accent)"},children:"Side A"}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginLeft:"8px"},children:["(",t.teamsA.length," teams)"]})]}),e.jsx("div",{style:{display:"flex",gap:"24px",overflowX:"auto",justifyContent:"center"},children:s.map(({roundNum:a,matches:l})=>e.jsx(M,{matches:l,roundNum:a,totalRounds:t.numRoundsA,onMatchClick:i},a))})]}),t.grandFinal&&e.jsxs("div",{className:"bracket-final",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"24px"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--success)",fontWeight:"bold",marginBottom:"16px"},children:"ðŸ† GRAND FINAL ðŸ†"}),e.jsx(D,{match:t.grandFinal,onClick:i})]}),e.jsxs("div",{className:"bracket-side side-b",style:{flex:1,minWidth:"280px",maxWidth:"400px",border:"2px solid rgba(245, 158, 11, 0.3)",borderRadius:"12px",padding:"16px",background:"rgba(245, 158, 11, 0.05)"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"16px"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"var(--warning)"},children:"Side B"}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginLeft:"8px"},children:["(",t.teamsB.length," teams)"]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"row-reverse",gap:"24px",overflowX:"auto",justifyContent:"center"},children:n.map(({roundNum:a,matches:l})=>e.jsx(M,{matches:l,roundNum:a,totalRounds:t.numRoundsB,onMatchClick:i},a))})]})]})},J=()=>{const{state:t,dispatch:i}=w(),s=R(),[n,a]=L.useState(null),l=t.bracket,o=m=>{a(m)},d=(m,h)=>{if(n===null||!l)return;const b=V(l,n,m,h);i({type:"SET_BRACKET",bracket:b}),a(null)},u=()=>{i({type:"CLEAR_BRACKET"})},c=x.useMemo(()=>{if(!l||n===null)return null;if(l.isDualBracket){const m=l;return m.matchesA.find(h=>h.id===n)||m.matchesB.find(h=>h.id===n)||(m.grandFinal?.id===n?m.grandFinal:null)}else return l.matches.find(h=>h.id===n)||null},[l,n]);if(!l)return e.jsx("div",{className:"bracket-page tournament-page",children:e.jsxs("div",{className:"bracket-view-container min-h-screen py-8",children:[e.jsxs("div",{className:"page-intro-header text-center max-w-[600px] mx-auto mb-8 px-4",children:[e.jsx("h2",{className:"text-3xl mb-1 text-white",children:"Tournament Bracket"}),e.jsx("p",{className:"text-text-muted",children:"No bracket created yet."})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(y,{onClick:()=>s("/tournament/bracket/setup"),children:"Create Bracket"})})]})});const p=l.isDualBracket?`Side A vs Side B${l.hasSharedFinal?" â€¢ Winners meet in Grand Final":""}`:`${l.teams.length} teams â€¢ Single Elimination`;return e.jsx("div",{className:"bracket-page tournament-page",children:e.jsxs("div",{className:"bracket-view-container min-h-screen py-8",children:[e.jsxs("div",{className:"page-intro-header text-center max-w-[600px] mx-auto mb-8 px-4",children:[e.jsx("h2",{className:"text-3xl mb-1 text-white",children:"Tournament Bracket"}),e.jsx("p",{className:"text-text-muted",children:p})]}),e.jsxs("div",{className:"bracket-actions flex justify-center items-center gap-4 mb-8 flex-wrap",children:[e.jsx(y,{variant:"secondary",size:"sm",onClick:()=>window.print(),children:"Print"}),e.jsx(y,{variant:"danger",size:"sm",onClick:u,children:"Clear"})]}),l.isDualBracket?e.jsx(q,{bracket:l,onMatchClick:o}):e.jsx(Y,{bracket:l,onMatchClick:o}),c&&e.jsx(X,{match:c,onClose:()=>a(null),onSave:d})]})})},ae=()=>{const{state:t}=w(),i=t.bracket&&(t.bracket.isDualBracket?(t.bracket.matchesA?.length??0)>0||(t.bracket.matchesB?.length??0)>0:(t.bracket.matches?.length??0)>0);return x.useEffect(()=>U({title:"Padel Bracket Generator | Single Elimination Tournaments",description:"Create padel bracket tournaments in minutes. Add teams, auto-seed, and run single elimination brackets with live scoring.",canonical:"https://padelcompanion.se/tournament/bracket",ogUrl:"https://padelcompanion.se/tournament/bracket"}),[]),e.jsxs("div",{className:"bracket-page tournament-page",children:[e.jsx(O,{}),i?e.jsx(J,{}):e.jsx(H,{})]})};export{ae as default};
